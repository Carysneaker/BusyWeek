/*! busyWeek 2014-12-16 */
function getDateStr(a){var b=a.getFullYear(),c=a.getMonth()+1,d=a.getDate(),d=10>d?"0"+d:d,e=b+"-"+c+"-"+d;return e}function getTodayDate(){var a=new Date;return getDateStr(a)}function getDateDiff(a,b){var c,d,e,f;return c=a.split("-"),d=new Date(c[0]+"-"+c[1]+"-"+c[2]),c=b.split("-"),e=new Date(c[0]+"-"+c[1]+"-"+c[2]),f=parseInt((d-e)/1e3/60/60/24)}function getDiffDate(a){var b=(new Date).getTime()+24e3*a*3600,c=new Date;return c.setTime(b),getDateStr(c)}Vue.filter("getDay",function(a){var b=new Date(a),c=b.getDay(),d=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"];return d[c]}),Vue.filter("getDayType",function(a){var b=getDateDiff(a,getTodayDate()),c=["今天","明天","后天","大后天","第五天","第六天","第七天","下周今天"];return c[b]?c[b]:b>0?b+"天后":-b+"天前"});var app=new Vue({el:"#app",data:{appName:"BusyWeek!",inputMode:!0,flagDate:"",newTodo:{dayType:"0",date:getTodayDate(),text:"",done:!1},_todos:[{text:"这个是示例哦～",done:!1}],_day:{dayType:"0",date:getTodayDate(),todos:this._todos},timeline:todoStorage.fetch()},created:function(){var a=navigator,b=(a.language||a.browserLanguage||a.userLanguage||"").substr(0,2);"zh"==b&&(this.appName="好忙啊")},ready:function(){this.$watch("timeline",function(a){todoStorage.save(a)},!0),this.$watch("newTodo.dayType",function(a){var b=getDiffDate(a);this.newTodo.date=b}),this.$watch("newTodo.date",function(a){var b=getDateDiff(a,getTodayDate());b>=0&&7>=b&&(this.newTodo.dayType=String(b))})},methods:{addTodo:function(a){a.preventDefault(),this.newTodo.text||(this.newTodo.text="写点啥呀！");var b=this.newTodo.date,c=this.timeline;c[b]||c.$add(b,{date:b,todos:[]}),c[b].todos.push(this.newTodo),this.newTodo={dayType:"0",date:b,text:"",done:!1},this.newTodo.date=b},removeTodo:function(a){this.timeline[a.date].todos.$remove(a.$data),0==this.timeline[a.date].todos.length&&this.timeline.$delete(a.date)},checkTodo:function(a){a.done=!a.done},editTodo:function(){},hackCheckbox:function(){return!1},enterInputMode:function(){},exitInputMode:function(){},ifToday:function(a){return a==getTodayDate()?!0:!1}}});